<!DOCTYPE html>



<html lang="en-US" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Linux System Programming - Part 3" />
<meta name="author" content="Cihat Yildiz" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Dosya Baglari (linkleri)" />
<meta property="og:description" content="Dosya Baglari (linkleri)" />
<link rel="canonical" href="www.cihatyildiz.com/posts/Linux-system-prog-part3/" />
<meta property="og:url" content="www.cihatyildiz.com/posts/Linux-system-prog-part3/" />
<meta property="og:site_name" content="Cihat Yildiz" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-10-20T20:55:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Linux System Programming - Part 3" />
<meta name="twitter:site" content="@cihatix" />
<meta name="twitter:creator" content="@Cihat Yildiz" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"datePublished":"2014-10-20T20:55:00+08:00","description":"Dosya Baglari (linkleri)","mainEntityOfPage":{"@type":"WebPage","@id":"www.cihatyildiz.com/posts/Linux-system-prog-part3/"},"url":"www.cihatyildiz.com/posts/Linux-system-prog-part3/","author":{"@type":"Person","name":"Cihat Yildiz"},"headline":"Linux System Programming - Part 3","dateModified":"2014-10-20T20:55:00+08:00","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Linux System Programming - Part 3 | Cihat Yildiz
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Cihat Yildiz">
<meta name="application-name" content="Cihat Yildiz">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/salyangoz.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Cihat Yildiz</a>
    </div>

    <div class="site-subtitle font-italic">cybersecurity, etc.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/cihatyildiz" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/cihatix" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['cihat.yildiz','gmail.com'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
        <span>
          
          
          <a href="/">
            Posts
          </a>
        </span>

        

      

        
          <span>Linux System Programming - Part 3</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->
  

  

  



<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Linux System Programming - Part 3</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Cihat Yildiz
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Mon, Oct 20, 2014,  8:55 PM +0800"
  

  
  prep="on" >

  
  

  
    Oct 20, 2014
  

  <i class="unloaded">2014-10-20T20:55:00+08:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2710 words">15 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h2 id="dosya-baglari-linkleri">Dosya Baglari (linkleri)</h2>

<p>Dosya baglari siki (hard) ve sembolik olmak uzere ikiye ayrilmaktadir. Hard link sisteminin anlasilabilmesi icin diskin metadata formatinin biliniyor olmasi gerekmektedir. Bir diskte okunabilecek veya yazilabilecek en kucu birim sektordur. Bir sektor varsayilan olarak 512 byte uzunlugundadir. Ancak isletim sistemleri diski sektpor temelinde organize etmek yerine block yada cluster denilen birimler ile organize etmektedir. Bir block yada Cluster ardisil n sektorden olusmaktadir. Bu sektorun sayisi formatlarken belirlenir.</p>

<p>Bir block yada cluster bis dosyanin parcasi olabilen en kucuk birimdir(ornegin 1 byte uzunlugunda bir dosya olusturacak olsak sistemda bu dosya icin 1 block yer ayrilir). Bir volumu ext2, ext3 gibi inode tabanli bir dosya sistemi ile formatlarsak kabaca diskte 3 bolum olusturulur. Bunlar super block, inode block, data block bolumleridir. Super Blok, bolumlerin yerlerini uzunluklarini vesaire tutan bir blogun kaz sektorden olustugunu tutan bolumdur. Volume’nin kalbidir. Inode block, inode elemanlarindan olusur. Her inode elemanina 0’dan baslayarak bir sira numarasi karsilik dusurulmustur. Bir dosyanin butun bigileri, yani stat fonksiyonu ile aldigimiz bilgiler inode elemaninda tutulur. Bir dosya yaratildiginda onun icin bir inode elemani olusturulur. Yani her dosyanin bir inode elemani vardir. Dizinler de birer dosya gibidir. Onlar icin de birer inode elemani vardir. BIr dosyanin inode numarasi demek o dosyanin bilgilerinin inode blogunun kacinci inode elemaninda saklandigi demekdir. dosyanin inode numarasi ls -i ile goruntulenmektedi 0 Numarali inode elemani kok dizinin elemanidir. Dizinler de dosyalar gibi bir dizin dosyasinin icerisinde dosya ismi ve inode numaralarindan olusan kayitlar vardir.</p>

<div class="table-wrapper"><table>
  <tbody>
    <tr>
      <td>isim</td>
      <td>inode no</td>
    </tr>
    <tr>
      <td>isim</td>
      <td>inode no</td>
    </tr>
    <tr>
      <td>isim</td>
      <td>inode no</td>
    </tr>
    <tr>
      <td>isim</td>
      <td>inode no</td>
    </tr>
    <tr>
      <td>…</td>
      <td>…</td>
    </tr>
  </tbody>
</table></div>

<p>Diskin data bolumu ilk blok sifirdan baslayacak sekilde bloklarla numaralandirilmistir. Her dosya data bolumu icerisinde bloklara parcalanmis bir bicimde oradaki bloklarda tutulmustur. Bu bloklar ardisil olmak zorunda degildir. Dosyanin parcalarinin hangi bloklarda oldugu inode elemaninda tutulmaktadir. isletim sisteminin dosya sistemi yol ifadelerinden oncelikle bir bir inode elemani elde etmelidir. Cunku dosyani butun kontrol bilgisi inode elemanindadir. Genel olarak bir yol ifadesinden o dosyaya iliskin inode elemaninin elde edilmesi surecine “Pathname resolution” denilmektedir. Pathname resolution su sekilde gerceklestirilir. Ornegin /home/csd/test.dat dosyasina erisilmek istensin;</p>

<ul>
  <li>Sistem 0 numarali inode elemanina gider. Onun bloklarini okur ve orada inode kayitlari vardir. Orada home isminii arar. Bulursa onun inode numarasini elde eder,</li>
  <li>Eger bulunan home ismi bir dizin dosyasina iliskinse ve erisim hakki varsa onun inode elemanina gide ve onun da bloklarini okur. Orada csd ismini arar ve onun inode numarasini elde eder.</li>
  <li>Artik csd’nin inode elemaninda onun bloklarina bakilarak bu kez orada test.dat aranir. ve nihayet dosyanin bilgisine erisir.</li>
</ul>

<h3 id="hardlink-nedir">Hardlink nedir?</h3>

<p>Hardlink farkli dizin girislerinin ayni inode numarasina sahip olmasidir. Boylece iki farkli yol ifadesiyle pathname resolution yapildiginda aslinda ayni dosyaya erisilmis olur. Ornegin</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/linux-link-table.png" alt="upload-image" /></p>

<p>Goruldugu gibi /home/kaan/b.dat dizin girisi ile /home/ali/y.dat dizin girisi ayni inode elemanini gostermektedir.</p>

<h4 id="peki-rm-gibi-bir-komutla-bu-dosyalardan-biri-silinse-ne-olur">Peki rm gibi bir komutla bu dosyalardan biri silinse ne olur?</h4>

<p>Eger dosyanin inode elemani ve inode bloklar free hale getirilirse diger yol ifadesiyle ardik diger dosyaya erisemiyoruz.iste bunun icin inode elemaninda isletimsistemi hardlink sayisini tutar. Dosya silinmeye calisildiginda once dizin girisini siler. Sonra dosyanin inode elemanina giderek oradaki hardlink sayacini 1 eksiltir. Eger sayac sifira duserse dosyanin inode numarasini ve o inoda bagli data bloklarini siler(metadata alanlari silinmis gibi gosterilir). Inode tabanli dosya sistemlerinde ayrica hangi inode elemanlarinin bos oldugu ve hangi data bloklarinin bos oldugu disk uzerinde bir yerlerde tutulmalidir. Suphesiz her blok yada inode elemani icin 1 bit yeterlidir. Ornegin ext2 dosya sisteminde bu bilgiler hemen superblok’tan asonra block bitmap ve inode bitmap isimleri ile tutulurlar.</p>

<p>Bir dosyanin hardlink’i komut satirinda ln komutu ile olusturulmaktadir.</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="gp">cx@debx86:~$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-il</span> a.txt
<span class="go">1061483 -rw-r--r-- 1 cx cx 4 Feb 18 15:10 a.txt
</span><span class="gp">cx@debx86:~$</span><span class="w"> </span><span class="nb">ln </span>a.txt b.txt
<span class="gp">cx@debx86:~$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-il</span> <span class="k">*</span>.txt
<span class="go">1061483 -rw-r--r-- 2 cx cx 4 Feb 18 15:10 a.txt
1061483 -rw-r--r-- 2 cx cx 4 Feb 18 15:10 b.txt
</span><span class="gp">cx@debx86:~$</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Bir dizin olusturuldugu zaman nokta ve nokta nokta isimli iki dizin otomatik yaratilmaktadir. BUnlar aslinda birer hardlink girisleridir. Boylece nokta dizini kendi dizinin hardlink sayacini 1 artirir. ikinokta dizini de ust dizinin harlnik sayacini 1 artirir.</p>

<h3 id="sembolik-link-dosyaları">Sembolik Link Dosyaları</h3>

<p>http://www.kaanaslan.com/resource/article/display_article.php?id=74 adresinden detayli bilgilerin elde edilmesi lazim</p>

<p>Sembolik link dosyalari normal bir dosya gibidir. NOrmal bir dosyanin icerisinde dosyanin bilgileri vardir fakat sembolik link dosyalarinin icerisinde o dosyanin belirtdigi asil dosyanin yol ifadesi vardir. Pekcok sistem ve posix fonksiyonuna biz sembolik bir dosyanin yol ifadesini verdigimizde o aslinda o dosyani belirttigi asil dosya uzerinde islem yapar. Bazen sembolik link izlemek probleme yol acabilir. Ornegin dizin agacini dolasirken biz baska bir dizine bir sembolik link gordugumuzde o dizine gecersek ve o dizin de bizim dizinimizi kapsiyor ise sonsuz dongu olusur. Bu nedenle bazi fonksiyonlari “l” ile baslayan versiyonlari olusturulmustur. Fponksiyonlarin bu “l” ‘li versiyonlari sembolik link dosyasi soz konusu oldugunda o dosyanin kendisi uzerinde islem yapar. Dosyanin gosterdigi dosya uzerinde degil. Ornegin stat fonksiyonunun lstat isimli bir verisonu vardir. Sembolik baglanti dosyasi baska bir sembolik baglanti dosyasini gosterebilir. Hatta dongusel bir durum bile olusabilir. Boyle bir dongusel durumda sistem fonsiyonlar bunu tespit eder ve hata ile donus yapar. errno degiskenine ELOOP degeri set eder. Bazi fonksiyonlar hic sembolik baglantilari izlememektedir. Dogrudan sembolk dosyanin kendisi uzerinde islem yapmaktadir. hardlink dosyasi olusturabilmek icin link isimli bir fonksiyon vardir. Sembolik link olusturabilmek icin symlink isimli fonksiyon kullanilmaktadir.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;unistd.h&gt;
</span><span class="kt">int</span> <span class="nf">link</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">oldpath</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">newpath</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">symlink</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">oldpath</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">newpath</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Komut satirindan sembolik link dosyalari ln -s komutu ile olusturulurlar. Sembolik dosyanin gosterdigi dosya silinir ise bu duruma danling link denilmektedir. Boylesi bir durumda open fonksiyonu ile bir dosya acmaya calisirsak olmayan bir dosyayi acmayaclisir gibi oluruz. Sembolik linkler ozellikle bazi dizinlere pratik erisim icin tercih edilmektedir.</p>

<h2 id="pogramin-calisma-dizini">Pogramin Calisma Dizini</h2>

<p>Her prosesin bir calisma dizini vardir. Prosesin calisma dizini prosesin kontrol blogunda saklanmaktadir. Prosesin calisma dizin fork sirasinda ust prosesden aktarilmaktadir. Prosesin calisma dizini goreli yol ifadelerinin cozulmesinde kullanilir. Eger yol ifadesinin ilk karakteri / ise bu mutlak bir yol ifadesidir. Mutlak yol ifadelerinin cozulmesi kok dizinden itibaren yapilir. Eger yol ifadesi / ile baslamiyor ise o zaman prosesin calisma dizininde itibaren belirtilen yolu kullanir. Prosesin calisma dizini goreli yol ifadelerinin cozulmesi icin bir orijin gorevi yapar.?</p>

<p>Peki biz login oldugumuzda shell prosesinin calisma dizini nasil belirlenmektedir?</p>

<p>Biz shell altinda bir program calistirdigimizda calismadizini shell ile ayni olacaktir. iste login programi bize ssiteme sokarken /etc/passwd dosyasindaki belirtilen programi (genellikle /bin/bash ) yine orada belirtilen calisma dizini olarak ayarlayarak calismaktadir. Bir proses calisirken kendi calisma dizinini chdir fonksiyonu ile degistirebilmektedir.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;unistd.h&gt;
</span><span class="kt">int</span> <span class="nf">chdir</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>fonksiyonun parametresi prosesin yeni calisma dizini olacaktir. Fonksiyon basari durumunda 0 basarisizlik durumunda -1 olarak geri doner. Bir proses baska bir prosesin calisma dizinini degistiremez. Boyle bir sistem fonksiyonu yoktur. Bu durumda ornegin shelin cd komutu aslinda calistirilabilir bir program degildir. shelin icsel komutudur.</p>

<p>Bir prosesin proses kontrol kontrol blogundaki / dizini kaydi degistirilebilir. Boylelikle uygulamayi bir dizin icerisine hapsedebiliriz.</p>

<p>Prosesin calisma dizini getcwd isimli posix fonksiyonu ile alinir. Fonksiyonun prototipi su sekildedir.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;unistd.h&gt;
</span><span class="kt">char</span> <span class="o">*</span><span class="nf">getcwd</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Fonksiyonun birinci parametresi calisma dizininin yerlestirilecegi bellek alani adresini ikinci parametresi de dizinin uzunlugunu alir. Fonksiyon basari durumunda birinci parametre ile girilen parametrenin aynisina, basarisizlik durumunda null olarak geri doner.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="cm">/*-----------------------------------------------------
 getcwd fonksiyonu
------------------------------------------------------*/</span>

<span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;dirent.h&gt;
</span>
<span class="kt">void</span> <span class="nf">exitsys</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
 <span class="kt">char</span> <span class="n">cwd</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">getcwd</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
  <span class="n">exitsys</span><span class="p">(</span><span class="s">"getcwd"</span><span class="p">);</span>

 <span class="n">puts</span><span class="p">(</span><span class="n">cwd</span><span class="p">);</span>

 <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="nf">exitsys</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span><span class="p">)</span>
<span class="p">{</span>
 <span class="n">perror</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
 <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="ornek-bir-shell-programi">Ornek Bir Shell Programi</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
</pre></td><td class="rouge-code"><pre><span class="cm">/*--------------------------------------------------------
 Örnek bir shell programi
---------------------------------------------------------*/</span>

<span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;time.h&gt;
#include &lt;errno.h&gt;
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;dirent.h&gt;
#include &lt;pwd.h&gt;
#include &lt;grp.h&gt;
</span>
<span class="cm">/* Symbolic Constants */</span>

<span class="cp">#define MAX_CMDLINE  1024
#define MAX_CMDPARAMS 100
#define MAX_PATH  4096
</span>
<span class="cm">/*  Type Declarations */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">tagCMD</span> <span class="p">{</span>
 <span class="kt">char</span> <span class="o">*</span><span class="n">cmdText</span><span class="p">;</span>
 <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">proc</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
<span class="p">}</span> <span class="n">CMD</span><span class="p">;</span>

<span class="cm">/* Function Prototypes */</span>

<span class="kt">void</span> <span class="nf">exitsys</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">parse_cmdline</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">char</span> <span class="o">*</span><span class="nf">getls</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">stat</span> <span class="o">*</span><span class="n">finfo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">linkSpace</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sizeSpace</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">getdigit_count</span><span class="p">(</span><span class="kt">int</span> <span class="n">val</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">cmd_remove</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cmd_cp</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cmd_clear</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cmd_ls</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cmd_cd</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* Global Definitions */</span>

<span class="kt">char</span> <span class="n">g_cmdLine</span><span class="p">[</span><span class="n">MAX_CMDLINE</span><span class="p">];</span>
<span class="kt">char</span> <span class="o">*</span><span class="n">g_cmdParams</span><span class="p">[</span><span class="n">MAX_CMDPARAMS</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">g_nParams</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">g_cwd</span><span class="p">[</span><span class="n">MAX_PATH</span><span class="p">];</span>

<span class="n">CMD</span> <span class="n">g_cmds</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
 <span class="p">{</span><span class="s">"rm"</span><span class="p">,</span> <span class="n">cmd_remove</span> <span class="p">},</span>
 <span class="p">{</span><span class="s">"cp"</span><span class="p">,</span> <span class="n">cmd_cp</span> <span class="p">},</span>
 <span class="p">{</span><span class="s">"clear"</span><span class="p">,</span> <span class="n">cmd_clear</span> <span class="p">},</span>
 <span class="p">{</span><span class="s">"ls"</span><span class="p">,</span> <span class="n">cmd_ls</span><span class="p">},</span>
 <span class="p">{</span><span class="s">"cd"</span><span class="p">,</span> <span class="n">cmd_cd</span><span class="p">},</span>
 <span class="p">{</span><span class="s">"chdir"</span><span class="p">,</span> <span class="n">cmd_cd</span><span class="p">},</span>

 <span class="p">{</span><span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">}</span>
<span class="p">};</span>

<span class="cm">/* Function Defitinions */</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
 <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

 <span class="k">for</span> <span class="p">(;;)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">getcwd</span><span class="p">(</span><span class="n">g_cwd</span><span class="p">,</span> <span class="n">MAX_PATH</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
   <span class="n">exitsys</span><span class="p">(</span><span class="s">"cwd"</span><span class="p">);</span>
  
  <span class="n">printf</span><span class="p">(</span><span class="s">"CSD:%s&gt;"</span><span class="p">,</span> <span class="n">g_cwd</span><span class="p">);</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">g_cmdLine</span><span class="p">);</span>
  <span class="n">parse_cmdline</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">g_nParams</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
   <span class="k">continue</span><span class="p">;</span>
 
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">g_cmdParams</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">"exit"</span><span class="p">))</span>
   <span class="k">break</span><span class="p">;</span>
 
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">g_cmds</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cmdText</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">g_cmdParams</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g_cmds</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cmdText</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">g_cmds</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">proc</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
   <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">g_cmds</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cmdText</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
   <span class="n">printf</span><span class="p">(</span><span class="s">"%s: command not found</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">g_cmdParams</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
 <span class="p">}</span>


 <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">parse_cmdline</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
 <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">;</span>

 <span class="n">g_nParams</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="k">for</span> <span class="p">(</span><span class="n">str</span> <span class="o">=</span> <span class="n">strtok</span><span class="p">(</span><span class="n">g_cmdLine</span><span class="p">,</span> <span class="s">" </span><span class="se">\t</span><span class="s">"</span><span class="p">);</span> <span class="n">str</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">;</span> <span class="n">str</span> <span class="o">=</span> <span class="n">strtok</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="s">" </span><span class="se">\t</span><span class="s">"</span><span class="p">))</span>
  <span class="n">g_cmdParams</span><span class="p">[</span><span class="n">g_nParams</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">str</span><span class="p">;</span>
 <span class="n">g_cmdParams</span><span class="p">[</span><span class="n">g_nParams</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">cmd_remove</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">"remove command...</span><span class="se">\n\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">cmd_cp</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
 <span class="kt">int</span> <span class="n">fds</span><span class="p">,</span> <span class="n">fdd</span><span class="p">;</span>
 <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span>
 <span class="k">struct</span> <span class="n">stat</span> <span class="n">finfo</span><span class="p">;</span>
 <span class="kt">ssize_t</span> <span class="n">n</span><span class="p">;</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">g_nParams</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"invalid cp command!..</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">if</span> <span class="p">((</span><span class="n">fds</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">g_cmdParams</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">O_RDONLY</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">"open"</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="k">if</span> <span class="p">((</span><span class="n">fdd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">g_cmdParams</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">O_WRONLY</span><span class="o">|</span><span class="n">O_CREAT</span><span class="o">|</span><span class="n">O_TRUNC</span><span class="p">,</span> 
                     <span class="n">S_IRUSR</span><span class="o">|</span><span class="n">S_IWUSR</span><span class="o">|</span><span class="n">S_IRGRP</span><span class="o">|</span><span class="n">S_IROTH</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">"open"</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">stat</span><span class="p">(</span><span class="n">g_cmdParams</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">finfo</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">"stat"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">if</span> <span class="p">((</span><span class="n">buf</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">finfo</span><span class="p">.</span><span class="n">st_blksize</span><span class="p">))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"not enough memory!..</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>
 
 <span class="k">while</span> <span class="p">((</span><span class="n">n</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">fds</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">finfo</span><span class="p">.</span><span class="n">st_blksize</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">write</span><span class="p">(</span><span class="n">fdd</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">perror</span><span class="p">(</span><span class="s">"write"</span><span class="p">);</span>
   <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
  <span class="p">}</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">"read"</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="n">close</span><span class="p">(</span><span class="n">fds</span><span class="p">);</span>
 <span class="n">close</span><span class="p">(</span><span class="n">fdd</span><span class="p">);</span>

 <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>

 <span class="n">printf</span><span class="p">(</span><span class="s">"1 file copied...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">cmd_clear</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">g_nParams</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"invalid clear command!..</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="n">system</span><span class="p">(</span><span class="s">"clear"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">cmd_ls</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
 <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">;</span>
 <span class="kt">DIR</span> <span class="o">*</span><span class="n">dir</span><span class="p">;</span>
 <span class="k">struct</span> <span class="n">dirent</span> <span class="o">*</span><span class="n">dire</span><span class="p">;</span>
 <span class="kt">char</span> <span class="n">fpath</span><span class="p">[</span><span class="n">MAX_PATH</span><span class="p">];</span>
 <span class="kt">int</span> <span class="n">nfiles</span><span class="p">;</span>
 <span class="k">struct</span> <span class="n">stat</span> <span class="o">*</span><span class="n">finfos</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
 <span class="k">struct</span> <span class="n">dirent</span> <span class="o">*</span><span class="n">dirents</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">maxLink</span><span class="p">,</span> <span class="n">maxSize</span><span class="p">,</span> <span class="n">maxLinkSpace</span><span class="p">,</span> <span class="n">maxSizeSpace</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">g_nParams</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">path</span> <span class="o">=</span> <span class="n">g_cwd</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">g_nParams</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">path</span> <span class="o">=</span> <span class="n">g_cmdParams</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
 <span class="k">else</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"ls: invalid command syntax</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">if</span> <span class="p">((</span><span class="n">dir</span> <span class="o">=</span> <span class="n">opendir</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">"opendir"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">for</span> <span class="p">(</span><span class="n">nfiles</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="n">dire</span> <span class="o">=</span> <span class="n">readdir</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">;</span> <span class="o">++</span><span class="n">nfiles</span><span class="p">)</span> <span class="p">{</span>
 
  <span class="k">if</span> <span class="p">(</span><span class="n">nfiles</span> <span class="o">%</span> <span class="mi">32</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">((</span><span class="n">finfos</span> <span class="o">=</span> <span class="n">realloc</span><span class="p">(</span><span class="n">finfos</span><span class="p">,</span> <span class="p">(</span><span class="n">nfiles</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">stat</span><span class="p">)))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
    <span class="n">exitsys</span><span class="p">(</span><span class="s">"realloc"</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">((</span><span class="n">dirents</span> <span class="o">=</span> <span class="n">realloc</span><span class="p">(</span><span class="n">dirents</span><span class="p">,</span> <span class="p">(</span><span class="n">nfiles</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">dirent</span><span class="p">)))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
    <span class="n">exitsys</span><span class="p">(</span><span class="s">"realloc"</span><span class="p">);</span>
  <span class="p">}</span>
   
  <span class="n">dirents</span><span class="p">[</span><span class="n">nfiles</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">dire</span><span class="p">;</span>
  <span class="n">sprintf</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s">"%s/%s"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">dire</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">stat</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">finfos</span><span class="p">[</span><span class="n">nfiles</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">perror</span><span class="p">(</span><span class="s">"stat"</span><span class="p">);</span>
   <span class="n">closedir</span><span class="p">(</span><span class="n">dir</span><span class="p">);</span>
   <span class="n">free</span><span class="p">(</span><span class="n">finfos</span><span class="p">);</span>
   <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
 <span class="p">}</span>

 <span class="n">maxLink</span> <span class="o">=</span> <span class="n">maxSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nfiles</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">maxLink</span> <span class="o">&lt;</span> <span class="n">finfos</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">st_nlink</span><span class="p">)</span>
   <span class="n">maxLink</span> <span class="o">=</span> <span class="n">finfos</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">st_nlink</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">maxSize</span> <span class="o">&lt;</span> <span class="n">finfos</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">st_size</span><span class="p">)</span>
   <span class="n">maxSize</span> <span class="o">=</span> <span class="n">finfos</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">st_size</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="n">maxLinkSpace</span> <span class="o">=</span> <span class="n">getdigit_count</span><span class="p">(</span><span class="n">maxLink</span><span class="p">);</span>
 <span class="n">maxSizeSpace</span> <span class="o">=</span> <span class="n">getdigit_count</span><span class="p">(</span><span class="n">maxSize</span><span class="p">);</span>
 
 <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nfiles</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">sprintf</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s">"%s/%s"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">dirents</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">d_name</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">getls</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">finfos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">maxLinkSpace</span><span class="p">,</span> <span class="n">maxSizeSpace</span><span class="p">));</span>
 <span class="p">}</span>

 <span class="n">free</span><span class="p">(</span><span class="n">finfos</span><span class="p">);</span>
 <span class="n">free</span><span class="p">(</span><span class="n">dirents</span><span class="p">);</span>
  
 <span class="n">closedir</span><span class="p">(</span><span class="n">dir</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">char</span> <span class="o">*</span><span class="nf">getls</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">stat</span> <span class="o">*</span><span class="n">finfo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">linkSpace</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sizeSpace</span><span class="p">)</span>
<span class="p">{</span>
 <span class="kt">char</span> <span class="k">static</span> <span class="n">buf</span><span class="p">[</span><span class="mi">4096</span><span class="p">];</span>
 <span class="kt">int</span> <span class="n">index</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">aflags</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">S_IRUSR</span><span class="p">,</span> <span class="n">S_IWUSR</span><span class="p">,</span> <span class="n">S_IXUSR</span><span class="p">,</span> <span class="n">S_IRGRP</span><span class="p">,</span> 
                     <span class="n">S_IWGRP</span><span class="p">,</span> <span class="n">S_IXGRP</span><span class="p">,</span> <span class="n">S_IROTH</span><span class="p">,</span> <span class="n">S_IWOTH</span><span class="p">,</span> <span class="n">S_IXOTH</span><span class="p">};</span>
 <span class="kt">char</span> <span class="o">*</span><span class="n">rights</span> <span class="o">=</span> <span class="s">"rwx"</span><span class="p">;</span>
 <span class="k">struct</span> <span class="n">passwd</span> <span class="o">*</span><span class="n">pwd</span><span class="p">;</span>
 <span class="k">struct</span> <span class="n">group</span> <span class="o">*</span><span class="n">grp</span><span class="p">;</span>
 <span class="kt">char</span> <span class="o">*</span><span class="n">months</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Oca"</span><span class="p">,</span> <span class="s">"Þub"</span><span class="p">,</span> <span class="s">"Mar"</span><span class="p">,</span> <span class="s">"Nis"</span><span class="p">,</span> <span class="s">"May"</span><span class="p">,</span> 
                        <span class="s">"Haz"</span><span class="p">,</span> <span class="s">"Tem"</span><span class="p">,</span> <span class="s">"Aðu"</span><span class="p">,</span> <span class="s">"Eyl"</span><span class="p">,</span> <span class="s">"Eki"</span><span class="p">,</span> <span class="s">"Kas"</span><span class="p">,</span> <span class="s">"Ara"</span><span class="p">};</span>
 <span class="k">struct</span> <span class="n">tm</span> <span class="o">*</span><span class="n">ftime</span><span class="p">;</span>
 <span class="kt">char</span> <span class="o">*</span><span class="n">lastSlash</span><span class="p">;</span>
 
 <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">S_ISREG</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mode</span><span class="p">))</span>
  <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'-'</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">S_ISDIR</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mode</span><span class="p">))</span>
  <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'d'</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">S_ISCHR</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mode</span><span class="p">))</span>
  <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'c'</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">S_ISBLK</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mode</span><span class="p">))</span>
  <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'b'</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">S_ISFIFO</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mode</span><span class="p">))</span>
  <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'p'</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">S_ISLNK</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mode</span><span class="p">))</span>
  <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'l'</span><span class="p">;</span>
 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">S_ISSOCK</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mode</span><span class="p">))</span>
  <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'s'</span><span class="p">;</span>

 <span class="o">++</span><span class="n">index</span><span class="p">;</span>

 <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
  <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mode</span> <span class="o">&amp;</span> <span class="n">aflags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">?</span> <span class="n">rights</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span> <span class="o">:</span> <span class="sc">'-'</span><span class="p">;</span>
 <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="sc">' '</span><span class="p">;</span>

 <span class="n">index</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s">"%*lu"</span><span class="p">,</span> <span class="n">linkSpace</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_nlink</span><span class="p">);</span>
 <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="sc">' '</span><span class="p">;</span>
 
 <span class="k">if</span> <span class="p">((</span><span class="n">pwd</span> <span class="o">=</span> <span class="n">getpwuid</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_uid</span><span class="p">))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
  <span class="n">index</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s">"%lu"</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_uid</span><span class="p">);</span>
 <span class="k">else</span>
  <span class="n">index</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s">"%s"</span><span class="p">,</span> <span class="n">pwd</span><span class="o">-&gt;</span><span class="n">pw_name</span><span class="p">);</span>
 <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="sc">' '</span><span class="p">;</span>
 
 <span class="k">if</span> <span class="p">((</span><span class="n">grp</span> <span class="o">=</span> <span class="n">getgrgid</span><span class="p">(</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_gid</span><span class="p">))</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
  <span class="n">index</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s">"%lu"</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_gid</span><span class="p">);</span>
 <span class="k">else</span>
  <span class="n">index</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s">"%s"</span><span class="p">,</span> <span class="n">grp</span><span class="o">-&gt;</span><span class="n">gr_name</span><span class="p">);</span>
 <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="sc">' '</span><span class="p">;</span>

  <span class="n">index</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s">"%*ld"</span><span class="p">,</span> <span class="n">sizeSpace</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span> <span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_size</span><span class="p">);</span>
 <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="sc">' '</span><span class="p">;</span>

 <span class="n">ftime</span> <span class="o">=</span> <span class="n">localtime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">finfo</span><span class="o">-&gt;</span><span class="n">st_mtime</span><span class="p">);</span>

 <span class="n">lastSlash</span> <span class="o">=</span> <span class="n">strrchr</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="sc">'/'</span><span class="p">);</span>
 <span class="n">index</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s">"%s %d %02d:%02d %s"</span><span class="p">,</span> <span class="n">months</span><span class="p">[</span><span class="n">ftime</span><span class="o">-&gt;</span><span class="n">tm_mon</span><span class="p">],</span> 
                        <span class="n">ftime</span><span class="o">-&gt;</span><span class="n">tm_mday</span><span class="p">,</span><span class="n">ftime</span><span class="o">-&gt;</span><span class="n">tm_hour</span><span class="p">,</span> <span class="n">ftime</span><span class="o">-&gt;</span><span class="n">tm_min</span><span class="p">,</span> <span class="n">lastSlash</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
 <span class="n">buf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'\0'</span><span class="p">;</span>

 <span class="k">return</span> <span class="n">buf</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">cmd_cd</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">g_nParams</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"cd: invalid command syntax!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">chdir</span><span class="p">(</span><span class="n">g_cmdParams</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">perror</span><span class="p">(</span><span class="s">"cmd:"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">getdigit_count</span><span class="p">(</span><span class="kt">int</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
 <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

 <span class="k">while</span> <span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="p">{</span>
  <span class="o">++</span><span class="n">count</span><span class="p">;</span>
    <span class="n">val</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">exitsys</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span><span class="p">)</span>
<span class="p">{</span>
 <span class="n">perror</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
 <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>bu yazmis oldugumuz shell uygulamasini /etc/passwd icerisinde bir kullanicinin shelli icine yazarsak eger login olan kullanici bizim yazdigimiz shell uygulamasina girer.</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="go">test:x:1001:1000:test,,,:/home/test:/bin/csdsh
</span></pre></td></tr></tbody></table></code></div></div>

<p>Derledigimiz uygulamamizi /bin/sh icerisine ekleyoruz. Bu uygulama icin calistirma yetkisi de vermemiz lazim.</p>

<h2 id="dosyalarin-silinmesi">Dosyalarin Silinmesi</h2>

<p>Dosyayi silmek icin remove ve unlink isimli iki esdeger fonksiyon kullanilabilmektedir. Unlink fonksiyonunu prototipi unistd.h icerisinde, remove fonksiyonunun prototipi stdio.h icerisindedir.her iki fonksiyon da once hardlink sayacini 1 eksiltir. Duruma gore dosyanin inoce bilgilerini siler.Bir dosyayi silebilmek icin yada bir dosyayi yaratabilmek icin o dosyanin icinde bulundugu dizine yazma hakkimizin olmasi gerekmektedir. Ayrica biz baskasinin sahibi oldugu dosyalari silemeyiz. Yani silecegimiz dosyanin userid prosesimizin etkin userid degeri ile ayni olmasi gerekmetedir. Fakat silem islemi icin dosyaya write hakki olmasi gerekmemetedir</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;unistd.h&gt;
</span><span class="kt">int</span> <span class="nf">unlink</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pathname</span><span class="p">);</span>
<span class="cp">#include &lt;stdio.h&gt;
</span><span class="kt">int</span> <span class="nf">remove</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pathname</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="dizinlerdeki-x-hakki">Dizinlerdeki x hakki</h3>

<h4 id="dizinlerdeki-erisim-haklari">Dizinlerdeki erisim haklari</h4>

<p>Bir dosyaya pathname resolution sirasinda erisebilmek icin yol ifadesinde bulunan butun dizinlere x hakkinin olmasi gerekmektedir. Yani dizinlerde x hakki icinden gecmek anlamina gelmektedir. ornegin biz stat fonksiyonu ile yada diger bir fonksiyonla /home/kaan/ali/x.dat dosyasini belirtmek isteyelim. Bizim bu islemi yapabilmemiz icin home, kaan ve ali dizinine x hakkina sahip olmamiz gerekmektedir. Bir dizine write hakkinin olmasi o disin dosyasinin dizin girisleri uzerinde degisiklikler yapilabilmesi denilmektedir. Yani o dizinden dosya yaratma, dosya silmek,rename islemi yapmak bu haklari gerektirir.</p>

<p>Ornegin biz /a/b/c dizininde bir dosya yaratmak isteyelim. Burada bizim a, b ve c dizinlerinin hepsine x hakkimizin olmasi gerekir. fakat c dizinine w hakkimizin olmasi yeterlidir.Bir dizine read hakkinin olmasi demek o dizinin dizin listesinin goruntulenebilmesi demekdir. Teknik olarak bu kontrol opendir fonksiyonu tarafindan yapilmaktadir. Yine /a/b/c/ dizininin listesini almak istediginizde a/b/c ye x hakkimizin olmasi gerekmektedir. Fakat yalnizca c dizinine read hakki olmasi yeterlidir. Ilginc bir nokta su olabilir. Asagidaki open fonksiyonunda tum dizinlere x hakkinin oldugunu dusunelim. Dosyaninda gercekten orada var oldugunu kabul edelim. Dosyanin bulundugu dizine okuma hakkimiz olmadigi halde eger dosyaya okuma hakkimiz var ise bu islem basarilidir.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">"/a/b/c/x.dat"</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/notes/'>Notes</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/writing/"
            class="post-tag no-text-decoration" >writing</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Linux System Programming - Part 3 - Cihat Yildiz&url=www.cihatyildiz.com/posts/Linux-system-prog-part3/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Linux System Programming - Part 3 - Cihat Yildiz&u=www.cihatyildiz.com/posts/Linux-system-prog-part3/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Linux System Programming - Part 3 - Cihat Yildiz&url=www.cihatyildiz.com/posts/Linux-system-prog-part3/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/posts/a-cheatsheet-for-docker/">A Cheatsheet for Docker</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/writing/">writing</a>
      
        
        <a class="post-tag" href="/tags/ctf/">ctf</a>
      
        
        <a class="post-tag" href="/tags/api/">api</a>
      
        
        <a class="post-tag" href="/tags/dba/">dba</a>
      
        
        <a class="post-tag" href="/tags/docker/">docker</a>
      
        
        <a class="post-tag" href="/tags/http/">http</a>
      
        
        <a class="post-tag" href="/tags/scanning/">scanning</a>
      
        
        <a class="post-tag" href="/tags/web-security/">web security</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/useful-sql-queries-for-nexpose/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Aug 30, 2020
  

  <i class="unloaded">2020-08-30T20:55:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Useful SQL Queries for Nexpose</h3>
            <div class="text-muted small">
              <p>
                





                Nexpose has lots of features to generate reports. But in some cases, the features in the UI may not be useful for you. You may need to create custom reports for your vulnerability management proces...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/create-secure-file-container/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Apr 11, 2017
  

  <i class="unloaded">2017-04-11T20:55:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Create an Encrypted File Container by Using Luks</h3>
            <div class="text-muted small">
              <p>
                





                1
#dd if=/dev/urandom of=/dosya/yolu/guvenlidosya bs=1M count=500


Eger kurumsal veya kendinize ait verileri sifreli bir alanda tutmak icin luks ile sifreli bir alan olusturup verilerinizi bu anda...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/phhpvirtualbox-on-ubunntu/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 28, 2017
  

  <i class="unloaded">2017-05-28T20:55:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using Virtualbox/phpVirtualbox on Ubuntu Server</h3>
            <div class="text-muted small">
              <p>
                





                Bu yazıda Ubuntu Server LTS üzerine Virtualbox sanallaştırma ortamı ve bu sanallaştırma ortamını web üzerinden yönetebilmek için geliştirilen phpVirtualbox sisteminin kurulumundan bahsedeceğiz.
Önc...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/Linux-system-prog-part2/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Linux System Programming - Part 2</p>
  </a>
  

  
  <a href="/posts/Linux-system-prog-part4/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Linux System Programming - Part 4</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/cihatix">Cihat Yildiz</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/writing/">writing</a>
      
        
        <a class="post-tag" href="/tags/ctf/">ctf</a>
      
        
        <a class="post-tag" href="/tags/api/">api</a>
      
        
        <a class="post-tag" href="/tags/dba/">dba</a>
      
        
        <a class="post-tag" href="/tags/docker/">docker</a>
      
        
        <a class="post-tag" href="/tags/http/">http</a>
      
        
        <a class="post-tag" href="/tags/scanning/">scanning</a>
      
        
        <a class="post-tag" href="/tags/web-security/">web security</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="www.cihatyildiz.com{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>


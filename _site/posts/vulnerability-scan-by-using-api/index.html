<!DOCTYPE html>



<html lang="en-US" 
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Nexpose Vulnerability Scan by Using Rest-API" />
<meta name="author" content="Cihat Yildiz" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Vulnerability scan tools you identify vulnerabilities in your infrastructure. You can perform manual and automated scans. But, in some cases, you may need to integrate your scannner with another tool such as devops pipeline (jenkins) or VM build pipeline. You cannot use automated scans in this type of integgrations. For example, lets say that you have build pipeline to generate a new virtual machine (VM). You can create number of macihnes in a day by usinng this pipeline. After build process, you need check that the asset doesn’t have any high and critical vulnerabilities. So your deployment process should be blocked if there is any high or critical vulnerability on assets." />
<meta property="og:description" content="Vulnerability scan tools you identify vulnerabilities in your infrastructure. You can perform manual and automated scans. But, in some cases, you may need to integrate your scannner with another tool such as devops pipeline (jenkins) or VM build pipeline. You cannot use automated scans in this type of integgrations. For example, lets say that you have build pipeline to generate a new virtual machine (VM). You can create number of macihnes in a day by usinng this pipeline. After build process, you need check that the asset doesn’t have any high and critical vulnerabilities. So your deployment process should be blocked if there is any high or critical vulnerability on assets." />
<link rel="canonical" href="www.cihatyildiz.com/posts/vulnerability-scan-by-using-api/" />
<meta property="og:url" content="www.cihatyildiz.com/posts/vulnerability-scan-by-using-api/" />
<meta property="og:site_name" content="Cihat Yildiz" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-20T20:55:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Nexpose Vulnerability Scan by Using Rest-API" />
<meta name="twitter:site" content="@cihatix" />
<meta name="twitter:creator" content="@Cihat Yildiz" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"datePublished":"2020-10-20T20:55:00+08:00","description":"Vulnerability scan tools you identify vulnerabilities in your infrastructure. You can perform manual and automated scans. But, in some cases, you may need to integrate your scannner with another tool such as devops pipeline (jenkins) or VM build pipeline. You cannot use automated scans in this type of integgrations. For example, lets say that you have build pipeline to generate a new virtual machine (VM). You can create number of macihnes in a day by usinng this pipeline. After build process, you need check that the asset doesn’t have any high and critical vulnerabilities. So your deployment process should be blocked if there is any high or critical vulnerability on assets.","mainEntityOfPage":{"@type":"WebPage","@id":"www.cihatyildiz.com/posts/vulnerability-scan-by-using-api/"},"url":"www.cihatyildiz.com/posts/vulnerability-scan-by-using-api/","author":{"@type":"Person","name":"Cihat Yildiz"},"headline":"Nexpose Vulnerability Scan by Using Rest-API","dateModified":"2020-10-20T20:55:00+08:00","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Nexpose Vulnerability Scan by Using Rest-API | Cihat Yildiz
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Cihat Yildiz">
<meta name="application-name" content="Cihat Yildiz">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/salyangoz.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Cihat Yildiz</a>
    </div>

    <div class="site-subtitle font-italic">cybersecurity, etc.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/cihatyildiz" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/cihatix" aria-label="twitter"
        
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['cihat.yildiz','gmail.com'].join('@')" aria-label="email"
        
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
        <span>
          
          
          <a href="/">
            Posts
          </a>
        </span>

        

      

        
          <span>Nexpose Vulnerability Scan by Using Rest-API</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->
  

  

  



<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Nexpose Vulnerability Scan by Using Rest-API</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Cihat Yildiz
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Tue, Oct 20, 2020,  8:55 PM +0800"
  

  
  prep="on" >

  
  

  
    Oct 20, 2020
  

  <i class="unloaded">2020-10-20T20:55:00+08:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1624 words">9 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p>Vulnerability scan tools you identify vulnerabilities in your infrastructure. You can perform manual and automated scans. But, in some cases, you may need to integrate your scannner with another tool such as devops pipeline (jenkins) or VM build pipeline. You cannot use automated scans in this type of integgrations. For example, lets say that you have build pipeline to generate a new virtual machine (VM). You can create number of macihnes in a day by usinng this pipeline. After build process, you need check that the asset doesn’t have any high and critical vulnerabilities. So your deployment process should be blocked if there is any high or critical vulnerability on assets.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/nexpose-pro_logo.jpg" alt="upload-image" /></p>

<p>In this post, I want to give you a working example that shows how to initiate a scan using nexpose api. I will create a python script for this.  Rapid7 have a nice documentation about nexpose api. For any kind of automation with nexpose, tihs is the best resource.</p>

<h1 id="prepare-nexpose-infrastructure">Prepare Nexpose Infrastructure</h1>

<p>Before to start script, we need to make some changes on Nexpose. I am not gonna explain details here. But I I did the below changes.</p>

<ul>
  <li>Create a site in nexpose</li>
  <li>Set default scan template for the site</li>
  <li>Create an account for API. The account should be able to initiate scan on the site.</li>
</ul>

<p>In my nexpose configuration each site have has been created for different purposes. I think I should create another site for the API scan. But you can use existing sites in your infrastructure.</p>

<h1 id="manunal-test">Manunal Test</h1>

<p>Now we can start coding. My code have two basic steps</p>

<ol>
  <li>Add the asset you want to scan into the site</li>
  <li>Initiate the nexpose scan on the site</li>
</ol>

<h2 id="1-add-assets-you-wannt-to-scan">1: Add assets you wannt to scan</h2>
<p>This step is important. Before initiate a scan, we need to update the asset list on the site. Because, nexpose will use the asset list of the site. To add asset list into the site I use the below API call.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>curl <span class="nt">--request</span> PUT <span class="se">\</span>
  <span class="nt">--url</span> https://NexposeServer/api/3/sites/&lt;site-id&gt;/included_targets <span class="se">\</span>
  <span class="nt">--header</span> <span class="s1">'Authorization: &lt;auth-key&gt;'</span> <span class="se">\</span>
  <span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  <span class="nt">--data</span> <span class="s1">'[
	"10.99.55.129",
	"172.16.13.45"
]'</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="3-start-the-scan">3: Start the scan</h2>
<p>The API call to initiate is simple.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>curl <span class="nt">--request</span> POST <span class="se">\</span>
  <span class="nt">--url</span> https://nexpose:3780/api/3/sites/&lt;site-id&gt;/scans <span class="se">\</span>
  <span class="nt">--header</span> <span class="s1">'Authorization: &lt;auth-key&gt;'</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="4-check-if-scan-completed">4: Check if scan completed</h2>
<p>When you initiate a scan successfully, the server will provide the scan id number as a result. So you can use this number to check if scan is completed.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>curl <span class="nt">--request</span> GET <span class="se">\</span>
  <span class="nt">--url</span> https://NexposeServer/api/3/scans/73341 <span class="se">\</span>
  <span class="nt">--header</span> <span class="s1">'Authorization: &lt;auth-key&gt;'</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="5-get-asset-vulnerabilities">5: Get Asset Vulnerabilities</h2>
<p>After the scan is completed, you can pull the vulnerability inforation from nexpose. it is a simple process. But there is two steps. We need to get asset id first, then we can get the findings by using asset id in the request.
You will need to use pagination to get all findings about the asset. But I did not use pagination in my code here.</p>

<p>Here is the query to get asset id:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>curl <span class="nt">--request</span> POST <span class="se">\</span>
  <span class="nt">--url</span> https://NexposeServer/api/3/assets/search <span class="se">\</span>
  <span class="nt">--header</span> <span class="s1">'Authorization: &lt;auth-key&gt;'</span> <span class="se">\</span>
  <span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  <span class="nt">--data</span> <span class="s1">'{
	"filters": [
		{
			"field": "ip-address",
			"operator": "is",
			"value": "10.99.55.129"
		}
	],
	"match": "all"
}'</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The request to get findings:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>curl <span class="nt">--request</span> GET <span class="se">\</span>
  <span class="nt">--url</span> <span class="s1">'https://NexposeServer/api/3/assets/&lt;asset-id&gt;/vulnerabilities?page=0&amp;size=500'</span> <span class="se">\</span>
  <span class="nt">--header</span> <span class="s1">'Authorization: &lt;auth-key&gt;'</span> <span class="se">\</span>
  <span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span>
</pre></td></tr></tbody></table></code></div></div>

<h1 id="the-script">The Script</h1>

<p>By using the requests above, I created two scripts. One for to initiate and one for to get scan results</p>

<p>This is the scripts to initiate a scan:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="n">json</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">requests.packages.urllib3</span>
<span class="kn">from</span> <span class="nn">requests.auth</span> <span class="kn">import</span> <span class="n">HTTPBasicAuth</span>

<span class="n">requests</span><span class="p">.</span><span class="n">packages</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="n">nexpose_username</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'NEXPOSE_USERNAME'</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">'"'</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
<span class="n">nexpose_password</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'NEXPOSE_PASSWORD'</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">'"'</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>

<span class="n">nexpose_asset_group_id</span> <span class="o">=</span> <span class="mi">332</span>
<span class="n">nexpose_db_scan_type</span> <span class="o">=</span> <span class="s">"nexpose"</span> <span class="c1"># not required
</span>
<span class="k">def</span> <span class="nf">addIpToNexposeSite</span><span class="p">(</span><span class="n">ip_address</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"addIpToNexposeSite"</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">ip_address</span>
    <span class="k">print</span><span class="p">(</span><span class="n">ip_address</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">"application/json"</span>
        <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://NexposeServer/api/3/sites/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nexpose_asset_group_id</span><span class="p">)</span> <span class="o">+</span> <span class="s">"/included_targets"</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">put</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span> <span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="n">nexpose_username</span><span class="p">,</span> <span class="n">nexpose_password</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">),</span>
        <span class="n">verify</span><span class="o">=</span><span class="bp">False</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"ASSET NOT EXIST!!"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">getNexposeScanStatus</span><span class="p">(</span><span class="n">scan_id</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://NexposeServer/api/3/scans/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">scan_id</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span> <span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="n">nexpose_username</span><span class="p">,</span> <span class="n">nexpose_password</span><span class="p">),</span>
        <span class="n">verify</span><span class="o">=</span><span class="bp">False</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"ERROR - get_scan_status"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">scan_status</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'status'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">scan_status</span>

<span class="k">def</span> <span class="nf">startNexposeScan</span><span class="p">(</span><span class="n">assets</span><span class="p">):</span>
    <span class="n">ip_addresses</span> <span class="o">=</span> <span class="n">assets</span>
    <span class="n">scan_id</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">print</span><span class="p">(</span><span class="n">ip_addresses</span><span class="p">)</span>
    <span class="n">addIpToNexposeSite</span><span class="p">(</span><span class="n">ip_addresses</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">"application/json"</span>
        <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://NexposeServer/api/3/sites/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nexpose_asset_group_id</span><span class="p">)</span> <span class="o">+</span> <span class="s">"/scans"</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span> <span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="n">nexpose_username</span><span class="p">,</span> <span class="n">nexpose_password</span><span class="p">),</span>
        <span class="n">verify</span><span class="o">=</span><span class="bp">False</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">201</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"SCAN DID NOT INITIATED!!"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">scan_id</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'id'</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">scan_id</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

    <span class="n">ips</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">startNexposeScan</span><span class="p">(</span><span class="n">ips</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This is the script to get findings</p>
<div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="n">json</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">requests.packages.urllib3</span>
<span class="kn">from</span> <span class="nn">requests.auth</span> <span class="kn">import</span> <span class="n">HTTPBasicAuth</span>

<span class="n">requests</span><span class="p">.</span><span class="n">packages</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="n">nexpose_username</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'NEXPOSE_USERNAME'</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">'"'</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
<span class="n">nexpose_password</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'NEXPOSE_PASSWORD'</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">'"'</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">getVulnDetails</span><span class="p">(</span><span class="n">vuln_id</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">"https://NexposeServer/api/3/vulnerabilities/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">vuln_id</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span> <span class="p">,</span>
            <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="n">nexpose_username</span><span class="p">,</span> <span class="n">nexpose_password</span><span class="p">),</span>
            <span class="n">verify</span><span class="o">=</span><span class="bp">False</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"ERROR - getVulnDetails"</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>

    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="s">'Exception - getVulnDetails()'</span><span class="p">)</span>
        <span class="k">return</span>


<span class="k">def</span> <span class="nf">getNexposeAssetID</span><span class="p">(</span><span class="n">ip_address</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">ip_address</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"filters"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s">"field"</span><span class="p">:</span> <span class="s">"ip-address"</span><span class="p">,</span>
                <span class="s">"operator"</span><span class="p">:</span> <span class="s">"is"</span><span class="p">,</span>
                <span class="s">"value"</span><span class="p">:</span> <span class="n">ip_address</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s">"match"</span><span class="p">:</span> <span class="s">"all"</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://NexposeServer/api/3/assets/search"</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="n">nexpose_username</span><span class="p">,</span>
        <span class="n">nexpose_password</span><span class="p">),</span>
        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">),</span>
        <span class="n">verify</span><span class="o">=</span><span class="bp">False</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"ASSET NOT EXIST!! T"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">aid</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()[</span><span class="s">'resources'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'id'</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="n">aid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">aid</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"No asset found"</span><span class="p">)</span>
            <span class="k">return</span><span class="p">(</span><span class="s">"No asset found"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">getNexposeVulns</span><span class="p">(</span><span class="n">asset_id</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://NexposeServer/api/3/assets/"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">asset_id</span><span class="p">)</span> <span class="o">+</span> <span class="s">"/vulnerabilities?page=0&amp;size=500"</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span> <span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="n">nexpose_username</span><span class="p">,</span> <span class="n">nexpose_password</span><span class="p">),</span>
        <span class="n">verify</span><span class="o">=</span><span class="bp">False</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"ERROR: getNexposeVulns"</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">getFormattedVuln</span><span class="p">(</span><span class="n">vuln</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">,</span> <span class="n">assetId</span><span class="p">):</span>
    <span class="c1"># print(vuln)
</span>    <span class="n">vulnDetails</span> <span class="o">=</span> <span class="n">getVulnDetails</span><span class="p">(</span><span class="n">vuln</span><span class="p">[</span><span class="s">'id'</span><span class="p">])</span>
    <span class="n">formattedVuln</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'appId'</span><span class="p">]</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'assetId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">assetId</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">vulnDetails</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'srcTool'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'nexpose'</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'srcToolId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">vuln</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'status'</span><span class="p">]</span> <span class="o">=</span> <span class="n">vuln</span><span class="p">[</span><span class="s">'status'</span><span class="p">]</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'severity'</span><span class="p">]</span> <span class="o">=</span> <span class="n">formatVulnImpact</span><span class="p">(</span><span class="n">vulnDetails</span><span class="p">[</span><span class="s">'cvss'</span><span class="p">][</span><span class="s">'v2'</span><span class="p">][</span><span class="s">'score'</span><span class="p">])</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'details'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">formattedVuln</span><span class="p">[</span><span class="s">'details'</span><span class="p">][</span><span class="s">'info'</span><span class="p">]</span> <span class="o">=</span> <span class="n">vulnDetails</span><span class="p">[</span><span class="s">'description'</span><span class="p">][</span><span class="s">'html'</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">formattedVuln</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="s">'Exception: getFormattedVuln'</span><span class="p">)</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span>

<span class="k">def</span> <span class="nf">formatVulnImpact</span><span class="p">(</span><span class="n">impact</span><span class="p">):</span>
    <span class="n">formattedImpact</span> <span class="o">=</span> <span class="s">'info'</span>
    <span class="k">if</span> <span class="n">impact</span> <span class="o">&lt;</span> <span class="mf">3.4</span><span class="p">:</span>
        <span class="n">formattedImpact</span> <span class="o">=</span> <span class="s">'low'</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">impact</span> <span class="o">&lt;</span> <span class="mf">6.7</span> <span class="ow">and</span> <span class="n">impact</span> <span class="o">&gt;=</span> <span class="mf">3.4</span> <span class="p">):</span>
        <span class="n">formattedImpact</span> <span class="o">=</span> <span class="s">'medium'</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">impact</span> <span class="o">&lt;</span> <span class="mi">9</span> <span class="ow">and</span> <span class="n">impact</span> <span class="o">&gt;=</span> <span class="mf">6.7</span> <span class="p">):</span>
        <span class="n">formattedImpact</span> <span class="o">=</span> <span class="s">'high'</span>
    <span class="k">elif</span> <span class="n">impact</span> <span class="o">&gt;=</span> <span class="mi">9</span> <span class="p">:</span>
        <span class="n">formattedImpact</span> <span class="o">=</span> <span class="s">'critical'</span>
    <span class="k">return</span> <span class="n">formattedImpact</span>

<span class="k">def</span> <span class="nf">printVulnerabilitiesOnCLI</span><span class="p">(</span><span class="n">vuln</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"Title"</span> <span class="p">:</span> <span class="n">vuln</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span>
        <span class="s">"ID"</span> <span class="p">:</span> <span class="n">vuln</span><span class="p">[</span><span class="s">'srcToolId'</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">asset_id</span> <span class="o">=</span> <span class="n">getNexposeAssetID</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
    <span class="n">raw_vulns</span> <span class="o">=</span> <span class="n">getNexposeVulns</span><span class="p">(</span><span class="n">asset_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">raw_vulns</span><span class="p">[</span><span class="s">'resources'</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">vuln</span><span class="p">[</span><span class="s">'status'</span><span class="p">]</span> <span class="o">==</span> <span class="s">"vulnerable"</span><span class="p">:</span>
                <span class="n">prep_vuln</span> <span class="o">=</span> <span class="n">getFormattedVuln</span><span class="p">(</span><span class="n">vuln</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">)</span>
                <span class="n">printVulnerabilitiesOnCLI</span><span class="p">(</span><span class="n">prep_vuln</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Exception in scan()'</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Here is the command line output of the scripts above:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="o">[</span>user@rhost]<span class="nv">$ </span>python3 nexposeResults.py 10.99.55.129
10.99.55.129
806026
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'IBM Java: Oracle July 14 2020 CPU (CVE-2020-14556)'</span>, <span class="s1">'ID'</span>: <span class="s1">'ibm-java-cve-2020-14556'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'IBM Java: Oracle July 14 2020 CPU (CVE-2020-14577)'</span>, <span class="s1">'ID'</span>: <span class="s1">'ibm-java-cve-2020-14577'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'IBM Java: Oracle July 14 2020 CPU (CVE-2020-14578)'</span>, <span class="s1">'ID'</span>: <span class="s1">'ibm-java-cve-2020-14578'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'IBM Java: Oracle July 14 2020 CPU (CVE-2020-14579)'</span>, <span class="s1">'ID'</span>: <span class="s1">'ibm-java-cve-2020-14579'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'IBM Java: Oracle July 14 2020 CPU (CVE-2020-14583)'</span>, <span class="s1">'ID'</span>: <span class="s1">'ibm-java-cve-2020-14583'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'IBM Java: Oracle July 14 2020 CPU (CVE-2020-14593)'</span>, <span class="s1">'ID'</span>: <span class="s1">'ibm-java-cve-2020-14593'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'IBM Java: Oracle July 14 2020 CPU (CVE-2020-14621)'</span>, <span class="s1">'ID'</span>: <span class="s1">'ibm-java-cve-2020-14621'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU October 2017 Java SE, Java SE Embedded, JRockit vulnerability (CVE-2016-10165)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-10165'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU January 2017 Java SE, Java SE Embedded Libraries vulnerability (CVE-2016-2183)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-2183'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU January 2017 Java SE, Java SE Embedded, JRockit Libraries vulnerability (CVE-2016-5546)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-5546'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU January 2017 Java SE, Java SE Embedded, JRockit Libraries vulnerability (CVE-2016-5547)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-5547'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU January 2017 Java SE, Java SE Embedded Libraries vulnerability (CVE-2016-5548)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-5548'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU January 2017 Java SE, Java SE Embedded Libraries vulnerability (CVE-2016-5549)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-5549'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU January 2017 Java SE, Java SE Embedded, JRockit Networking vulnerability (CVE-2016-5552)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-5552'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU January 2017 Java SE Java Mission Control vulnerability (CVE-2016-8328)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-8328'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU October 2017 Java SE, Java SE Embedded vulnerability (CVE-2016-9841)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2016-9841'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU July 2017 Java SE, Java SE Embedded, JRockit vulnerability (CVE-2017-10053)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2017-10053'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU July 2017 Java SE vulnerability (CVE-2017-10067)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2017-10067'</span><span class="o">}</span>
<span class="o">{</span><span class="s1">'Title'</span>: <span class="s1">'Java CPU July 2017 Java SE, Java SE Embedded vulnerability (CVE-2017-10074)'</span>, <span class="s1">'ID'</span>: <span class="s1">'jre-vuln-cve-2017-10074'</span><span class="o">}</span>
....
....
SNIP
....
....
<span class="o">[</span>user@rhost]<span class="nv">$ </span>python3 nexposeScan.py 10.99.55.129 10.6.55.152
<span class="o">[</span><span class="s1">'10.99.55.129'</span>, <span class="s1">'10.6.55.152'</span><span class="o">]</span>
addIpToNexposeSite
</pre></td></tr></tbody></table></code></div></div>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/vulnerability/'>vulnerability</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/api/"
            class="post-tag no-text-decoration" >api</a>
          
          <a href="/tags/scanning/"
            class="post-tag no-text-decoration" >scanning</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Nexpose Vulnerability Scan by Using Rest-API - Cihat Yildiz&url=www.cihatyildiz.com/posts/vulnerability-scan-by-using-api/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Nexpose Vulnerability Scan by Using Rest-API - Cihat Yildiz&u=www.cihatyildiz.com/posts/vulnerability-scan-by-using-api/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Nexpose Vulnerability Scan by Using Rest-API - Cihat Yildiz&url=www.cihatyildiz.com/posts/vulnerability-scan-by-using-api/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/writing/">writing</a>
      
        
        <a class="post-tag" href="/tags/ctf/">ctf</a>
      
        
        <a class="post-tag" href="/tags/api/">api</a>
      
        
        <a class="post-tag" href="/tags/dba/">dba</a>
      
        
        <a class="post-tag" href="/tags/docker/">docker</a>
      
        
        <a class="post-tag" href="/tags/http/">http</a>
      
        
        <a class="post-tag" href="/tags/scanning/">scanning</a>
      
        
        <a class="post-tag" href="/tags/web-security/">web security</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->




  
    
    
      
      
        
        
        
      
    
  
    
    
      
      
        
        
        
      
    
  
    
    
  
    
    
      
      
        
        
        
          





  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/hack-the-box-brainf/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Oct 24, 2020
  

  <i class="unloaded">2020-10-24T20:55:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup - Hack The Box - Brainfuck</h3>
            <div class="text-muted small">
              <p>
                





                In this post, I will show how I resolve the machine called Brainfuck. The difficulty of this macihne is hard.



Port and Service Discovery

Lets start with a basic nmap scan

1
2
3
4
5
6
7
8
9
10
...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/hack-the-box-lame/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Oct 24, 2020
  

  <i class="unloaded">2020-10-24T20:55:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup - Hack The Box - Lame</h3>
            <div class="text-muted small">
              <p>
                





                In this post, I will show how I resolve the machine called LAME. The difficulty of this macihne is easy. This is my first post about the hack the box machines. I will write more writeups about HTB ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/a-cheatsheet-for-docker/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Oct  1, 2020
  

  <i class="unloaded">2020-10-01T20:55:00+08:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>A Cheatsheet for Docker</h3>
            <div class="text-muted small">
              <p>
                





                if you are using Docker in your local or remote ennvironment, sometimes you might have trouble to manage Docker images and containers. I want to share a small cheatsheet that I used. I think this i...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/a-cheatsheet-for-docker/" class="btn btn-outline-primary"
    prompt="Older">
    <p>A Cheatsheet for Docker</p>
  </a>
  

  
  <a href="/posts/hack-the-box-lame/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Writeup - Hack The Box - Lame</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/cihatix">Cihat Yildiz</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/writing/">writing</a>
      
        
        <a class="post-tag" href="/tags/ctf/">ctf</a>
      
        
        <a class="post-tag" href="/tags/api/">api</a>
      
        
        <a class="post-tag" href="/tags/dba/">dba</a>
      
        
        <a class="post-tag" href="/tags/docker/">docker</a>
      
        
        <a class="post-tag" href="/tags/http/">http</a>
      
        
        <a class="post-tag" href="/tags/scanning/">scanning</a>
      
        
        <a class="post-tag" href="/tags/web-security/">web security</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="www.cihatyildiz.com{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

